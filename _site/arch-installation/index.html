
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>arch installation &larr; </title>
   <meta name="author" content="Xiang Chao" />

   <link rel="start" href="/" />

	
	
	
  	<link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/feedname" title="RSS feed" />
	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />

</head>
<body id="">
<div id="site">
  
  <div id="header">
    <h1>
    	<a href="/" title="cloudaice">cloudaice</a>
    	<span class="byline">&larr; <a href="/">Xiang Chao</a></span>
    </h1>
    <ul class="nav">
      <li><a class="home" href="/">Home</a></li>
      <li><a  href="/archive.html">Archive</a></li>
      <li><a  href="/pages.html">Pages</a></li>
      <li><a  href="/categories.html">Categories</a></li>
      <!--<li><a  href="/tags.html">Tags</a></li> -->
      <li><a  href='/picture.html'>Pic</a></li>
    </ul>
  </div>

  
<div id="page">
	
  <h1 class="emphnext">arch installation</h1>
  <ul class="tag_box inline">
  
  


  
    
  



  </ul>

  <h3>安装环境</h3>

<p>ubuntu 下的vmware8.0.1</p>

<h3>获得安装资源</h3>

<p>在<a href="www.archlinux.org/download">www.archlinux.org/download</a>下载core的镜像，我选择的是i686</p>

<p><strong>注</strong>：一共有两种镜像，core是用来本地安装的，而另外一个Netinstall是用来网络安装的，一般网络不好的都
是下载core镜像进行安装。</p>

<h3>配置虚拟机参数</h3>

<p>这里主要是设置Vmware中的一些硬件配置，基本和安装其它linnux发行版相似。我最后将打印机和软盘直接删除了，
另外网络选择nNAT连接。</p>

<h3>安装archlinux</h3>

<ul>
<li>打开Vmware运行开关</li>
<li>会进入一个命令行的界面</li>
</ul>


<h3>配置archlinux</h3>

<p>安装完成后，执行</p>

<pre><code>ping www.baidu.com
</code></pre>

<p>测试网络是否已经连接</p>

<pre><code>vi /etc/pacman.d/mirrorlist
</code></pre>

<p>观察里面的内容，将china下的源的注释去掉。设置软件下载源，选择设置中国的源，下载更新的时候速度会比较快。</p>

<p>执行</p>

<pre><code>pacman -Syy
</code></pre>

<p>刷新所有软件包</p>

<p>执行</p>

<pre><code>pacman -Syu
</code></pre>

<p>更新系统，在这里会遇到一些很难缠的问题，我在安装的时候出现了类似下面的错误信息：</p>

<pre><code>glibc: /usr/sbin/zic exists in filesystem
glibc: /usr/sbin/zdump exists in filesystem
glibc: /usr/bin/tzselect exists in filesystem
</code></pre>

<p>这个问题纠结了我很长的时间，一度让我几乎是中断了安装archlinux。解决方法如下：<br/>
显然，这里提示安装出现了冲突,可以强制更新pacman,输入下面的命令:</p>

<pre><code>pacman -Sf pacman
</code></pre>

<p>这条命令真的是异常好用,执行时候，屏幕上面会有一大堆的字，到最后会有这么一句警告：</p>

<pre><code>warning: /etc/pacman.conf installed as /etc/pacman.conf.pacnew
</code></pre>

<p>于是可以执行下面的命令对它进行修改</p>

<pre><code>mv /etc/pacman.conf.pacnew /etc/pacman.conf
</code></pre>

<p>编辑 /etc/pacman.conf文件
在[option]后面加上一行</p>

<pre><code>SigLevel = Never 
</code></pre>

<p>然后继续执行上面指令，更新系统:</p>

<pre><code>pacman -Syu
</code></pre>

<p>这个时候，就不会出现可恶的glibc了，因此，在我的机器上还是出现了冲突，其中一个是filesystem。但是，
这些问题很容易解决，只要执行下面命令就可以了：</p>

<pre><code>pacman -S filesystem --force
</code></pre>

<p>如果是碰到另外的包的名字，则可以把filesystem替换成另外的名字。
把这些冲突解决之后再运行</p>

<pre><code>pacman -Syu
</code></pre>

<p>直到更新完成后没有任何错误为止。
<em>走完这一步之后，下面的路基本上是平步青云了</em></p>

<h3>配置系统</h3>

<h5>安装Xorg</h5>

<pre><code>pacman -S xorg-server xorg-xinit xorg-utils xorg-server-utils
</code></pre>

<h5>安装mesa获得3D支持</h5>

<pre><code>pacman -S mesa
</code></pre>

<h5>查看显卡驱动</h5>

<pre><code>pacman –Ss xf86-video|more
</code></pre>

<h5>安装显卡驱动</h5>

<p>因为这里是在Vmware中安装arch，所以安装以下驱动</p>

<pre><code>pacman –S xf86-video-vmware
</code></pre>

<h5>查看输入设备驱动</h5>

<pre><code>pacman -Ss xf86-input
</code></pre>

<h5>安装鼠标，键盘，热插拔，触摸板驱动</h5>

<pre><code>pacman -S xf86-input-vmmouse xf86-input-keyboard xf86-input-evdev xf86-input-synaptics
</code></pre>

<h5>安装gnome守护程序dbus</h5>

<pre><code>pacman -S dbus
</code></pre>

<p>启动dbus进程</p>

<pre><code>rc.d start dbus
</code></pre>

<p>将dbus假如到守护进程中去,编辑/etc/rc.conf,在DAEMONS中添加dbus</p>

<pre><code>DAEMONS = (..dbus..)
</code></pre>

<h5>测试xorg的图形界面</h5>

<p>执行下面命令</p>

<pre><code>Xorg -configure
</code></pre>

<p>系统会在/root/下面生成一个xorg.conf.new的文件，我们需要将xorg.conf.new拷贝到/etc/X11/目录下，并且重命名为xorg.conf。命令如下</p>

<pre><code>cp /root/xorg.conf.new /etc/X11/xorg.conf
</code></pre>

<h5>安装测试图形界面的环境</h5>

<pre><code>pacman -S xorg-twm xorg-xclock xterm
</code></pre>

<p>测试xorg图形界面：</p>

<pre><code>startx
</code></pre>

<p>出现图形界面的命令行，你可以输入exit退出</p>

<h5>安装字体</h5>

<pre><code>pacman –S ttf-dejavu
</code></pre>

<h5>安装gnome</h5>

<p>在安装gnome之前先检查系统当前是不是最新,运行下面两条命令:</p>

<pre><code>pacman -Syu
pacman =Syy
</code></pre>

<p>安装gnome桌面</p>

<pre><code>pacman -S gnome
</code></pre>

<p>这里会问你要安装那些包，由于我是第一次安装，就选择默认，全部安装，因此直接敲击回车就可以。另外安装gnome需要下载较多的软件包。网络环境要好，
不然会花费较多的时间，这里我提供一个能够加快下载速度的方法：使用axel。一个linux下面的多线程下载工具。我们可以把它和pacman连在一起使用。方法如下
<strong>安装axel</strong></p>

<pre><code>pacman -S axel
</code></pre>

<p>修改配置文件</p>

<pre><code>vi /etc/pacman.conf
</code></pre>

<p>在option这一项里加上下面一句话</p>

<pre><code>XferCommand = /usr/bin/axel -n 5 -a -o %o %u
</code></pre>

<p>这样子，以后使用pacman下载的时候，就可以利用多线程的优势了。</p>

<p>安装gnome扩展</p>

<pre><code>pacman -S gnome-extra
</code></pre>

<p><strong>注</strong>:在这个过程中，如果安装结束出现类似下面的错误：</p>

<pre><code>error failed to commit transaction (invalid or corrupted package)
</code></pre>

<p>可能是因为安装包不完整导致的原因，进入/var/cache/pacman/pkg/目录下，执行下面命令寻找不完整的包：</p>

<pre><code>ls *.part*
</code></pre>

<p>看到列出的不完整的包，则手动删除。然后再重新安装相关软件。</p>

<p>安装vmware虚拟机扩展：</p>

<pre><code>pacman -S open-vm-tools
</code></pre>

<h5>启用gnome</h5>

<pre><code>startx
</code></pre>

<p>下面是一张图片
<img src="/images/arch-gnome.png" alt="arch-gnome" /></p>


  <address class="signature">
    <a class="author" href="/">Xiang Chao</a> 
    <span class="date">25 April 2012</span>
    <span class="location"></span>
  </address>
  
  <div class="prev-next">
  
    <a href="/selectpollepoll" class="next" title="select poll epoll">Next Post &rarr;</a>
  
  
    <a href="/deploy-with-gitosis" class="prev" title="deploy with gitosis">&larr; Earlier Post</a>
  
  </div>
  
</div><!-- End Page -->




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'cloudaice'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="/info/site.html">Xiang Chao</a>. Design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F804602e26e1df25cce6c94d5ac9e555e' type='text/javascript'%3E%3C/script%3E"));
</script>



</body>
</html>

